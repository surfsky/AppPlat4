## 系统安全策略

操作系统安全

- [x] 阿里云自带升级打补丁能力
- [x] 手动定期打上重要的补丁
- [x] 阿里云内置网站监控告警能力：CPU、内存，有异常立即告警（短信）

网络安全

- [x] 阿里云网站内置监控及流量控制等能力
- [x] 阿里云网站可配置端口访问能力: 80, 443, 3389, 1433, 1434
- [ ] 服务器上安装网络安全狗软件
- [ ] 聘请专门的网络防范管理员

网站访问安全

- [x] 后台管理页面必须登录后访问，且根据分配的权限进行页面及操作权限控制
- [x] 仅允许 https 方式访问：本系统对 http 做了 https 重定向处理，在IIS上做配置
- [x] 黑名单：禁止特定IP访问本系统，会返回网络错误信息，可在后台进行管理黑名单
- [x] 访问频率限制。超过限制则封禁IP。
- [x] 数据库日志：记录业务及网页访问异常数据，可在后台进行查询
- [x] 文本日志：记录所有访问日志，包括页面、时长、异常等。文件存储于 /Logs/，一天一个文件
- [x] 页面可做访问鉴权、编辑鉴权、删除鉴权：[Auth(Power.UserView)]
- [x] 页面可做登陆鉴权：[Auth(AuthLogin=true)]
- [x] 页面可做URL签名鉴权：[Auth(AuthSign=true)]
- [ ] 定时任务检测存储、CPU、内存，有异常立即告警（以数据库日志、短信的形式）

数据接口安全

- [x] 采用开源成熟接口框架 HttpApi
- [x] 公开接口：不带任何安全处理，可直接访问，如网站新闻信息
- [x] 带安全码接口：客户端请求时需增加 SecurityCode 参数（用Cookie或QueryString），如短信接口
- [x] 需登录后访问的接口：如我的订单等页面先需授权登录
- [x] 权限校验接口：非本人可见或可操作的数据，会返回404错误
- [x] SQL注入防范：系统DAL层不做任何Sql拼接操作，无此风险

JS 注入攻击防范

- [x] 大部分网页都禁止提交危险代码（如js脚本），由 Asp.net 默认机制阻止。
- [x] 允许编辑上传的网页，放开 Asp.net 过滤
- [x] 输出到网页端的数据，都做了HtmlEncode处理，不会触发js脚本

业务数据安全

- [x] 复杂数据操作依赖事务来实现数据完整性，如某些特殊订单
- [x] 数据并发冲突机制（多人同时修改一条记录）：使用锁，如订单序列号的生成
- [ ] 数据并发冲突机制（多人同时修改一条记录）：依赖 EntityFramework 的机制进行提示报错及刷新数据


数据备份方案

- [x] 数据库每日自动增量备份，每周完整备份。目录：d:/bak/
- [x] 网站每月备份，每次大改动都备份。目录：d:/bak/
- [ ] 异步备份方案，写脚本ftp传到其它服务器上，或类似百度云盘的同步功能
- [x] 异步备份方案，可租用阿里云的云备份服务
注：倒不是怕服务器挂掉，云主机的安全性还是挺强的，是怕误操作要数据回滚

密码安全策略

- [x] 密码在数据库中是单向加密存储的，不可反向得知密码明文
- [x] 密码长度应至少8位
- [x] 密码应该包含数字、字母、特殊字符
- [x] 密码不得包含用户名的完整字符串、大小写变化
- [x] 密码不得包含键盘上连续3个及3个以上字符，如 asd 1qa 123 321
- [ ] 密码要求n个月必须更换一次，且新密码不得与前两次密码一样
